# Диаграмма последовательности

## Предусловия

- Чат-бот онлайн в Телеграм
- Пользователь авторизован в Телеграм
- Специалист авторизован в Телеграм

## Постусловия

- Данные о завершённых диалогах чат-бота и пользователя получены
- Данные о завершённых диалогах чат-бота и пользователя сохранены

## Получение психологической помощи пользователем

### Текстовое описание

- Пользователь заходит в приложение Телеграм
- Телеграм отправляет запрос к API для проверки доступа в Интернет
- Авторизация в Телеграм по номеру телефона
- API отправляет сообщение с кодом авторизации
- Пользователь вводит код из сообщения для входа в свой аккаунт
- API подтверждает успешную авторизацию
- Пользователь в поиске ищет чат-бота @PsylogBot
- Формируется запрос к API
- API возвращает список пользователей
- Пользователь выбирает чат-бота и пишет ему сообщение
- Чат-бот отвечает пользователю, начат диалог
- Проблема пользователя решена, диалог завершён
    - API формирует JSON и выполняет SQL запрос в БД
- Пользователь может вызвать специалиста горячей линии, диалог завершён
    - API формирует JSON и выполняет SQL запрос в БД
- Чат-бот выявляет экстренный случай и уведомляет специалиста горячей линии, диалог завершён
    - API формирует JSON и выполняет SQL запрос в БД

### Диаграмма

```mermaid
sequenceDiagram
    Пользователь->>Телеграм: Заходит в Телеграм
    Телеграм->>API: Проверяет статус API
    Пользователь->>Телеграм: Авторизоваться
    Телеграм->>API: Отправляет номер телефона для обработки
    API->>Пользователь: Отправляет код авторизации в сообщении
    Пользователь->>Телеграм: Вводит код авторизации из сообщения
    API->>Телеграм: Подтверждает успешную авторизацию
    Пользователь->>Телеграм: Поиск чат-бота @PsylogBot
    API->>Телеграм: Возвращает список пользователей
    Пользователь->>Телеграм: Пишет чат-боту
    Телеграм->>Пользователь: Чат-бот отвечает пользователю
    Телеграм->>Телеграм: Проблема пользователя решена
    Телеграм->>API: Формируется JSON
    API->>БД: Выполняется SQL запрос
    Пользователь->>Телеграм: Просит вызвать специалиста
    Телеграм->>Телеграм: Чат-бот отправляет уведомление специалисту
    Телеграм->>API: Формируется JSON
    API->>БД: Выполняется SQL запрос
    Телеграм->>Телеграм: Чат-бот выявляет экстренный случай
    Телеграм->>Телеграм: Чат-бот отправляет уведомление специалисту
    Телеграм->>API: Формируется JSON
    API->>БД: Выполняется SQL запрос
```

## Оказание психологической помощи специалистом

### Текстовое описание

- Специалист заходит в приложение Телеграм
- Телеграм отправляет запрос к API для проверки доступа в Интернет
- Авторизация в Телеграм по номеру телефона
- API отправляет сообщение с кодом авторизации
- Специалист вводит код из сообщения для входа в свой аккаунт
- API подтверждает успешную авторизацию
- Специалист в поиске ищет чат-бота @PsylogBot, формируется запрос к API
- API возвращает список пользователей
- Специалист выбирает чат-бота и пишет ему сообщение, чтобы чат-бот мог ему написать в дальнейшем
- Специалист ждёт сообщение от чат-бота, когда понадобится его помощь
- Специалисту приходит сообщение от чат-бота, что требуется его помощь
- Специалист получает контакт человека, которому нужна помощь
- Специалист может попросить чат-бота показать диалог с этим человеком
- Специалист пишет человеку, чтобы решить возникшую проблему

### Диаграмма

```mermaid
sequenceDiagram
    Специалист->>Телеграм: Заходит в Телеграм
    Телеграм->>API: Проверяет статус API
    Специалист->>Телеграм: Авторизоваться
    Телеграм->>API: Отправляет номер телефона для обработки
    API->>Специалист: Отправляет код авторизации в сообщении
    Специалист->>Телеграм: Вводит код авторизации из сообщения
    API->>Телеграм: Подтверждает успешную авторизацию
    Специалист->>Телеграм: Поиск чат-бота @PsylogBot
    API->>Телеграм: Возвращает список пользователей
    Специалист->>Телеграм: Пишет чат-боту
    Телеграм->>Специалист: Чат-бот отвечает специалисту
    Специалист->>Специалист: Ждёт сообщение от чат-бота
    Телеграм->>Специалист: Чат-бот пишет специалисту, что требуется помощь
    Телеграм->>Специалист: Специалист получает контакт человека
    Специалист->>Телеграм: Просит чат-бота показать диалог с человеком
    Специалист->>Телеграм: Пишет человеку, чтобы помощь решить проблему
```
